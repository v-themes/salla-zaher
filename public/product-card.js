(()=>{"use strict";function t(n){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(n)}function n(n){var a=function(n){if("object"!=t(n)||!n)return n;var a=n[Symbol.toPrimitive];if(void 0!==a){var e=a.call(n,"string");if("object"!=t(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==t(a)?a:a+""}function a(t,a){for(var e=0;e<a.length;e++){var o=a[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function e(t){return e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},e(t)}function o(t,n){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},o(t,n)}function s(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(s=function(){return!!t})()}function i(t){var n="function"==typeof Map?new Map:void 0;return i=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(n){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,a)}function a(){return function(t,n,a){if(s())return Reflect.construct.apply(null,arguments);var e=[null];e.push.apply(e,n);var i=new(t.bind.apply(t,e));return a&&o(i,a.prototype),i}(t,arguments,e(this).constructor)}return a.prototype=Object.create(t.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),o(a,t)},i(t)}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(c=function(){return!!t})()}var r=function(n){function s(){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,s),n=this,a=e(a=s),function(n,a){if(a&&("object"==t(a)||"function"==typeof a))return a;if(void 0!==a)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(n)}(n,c()?Reflect.construct(a,[],e(n).constructor):a.apply(n,o));var n,a,o}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&o(t,n)}(s,n),i=s,r=[{key:"connectedCallback",value:function(){var t,n=this;this.product=this.product||JSON.parse(this.getAttribute("product")),"ready"===(null===(t=window.app)||void 0===t?void 0:t.status)?this.onReady():document.addEventListener("theme::ready",function(){return n.onReady()})}},{key:"onReady",value:function(){var t=this;this.fitImageHeight=salla.config.get("store.settings.product.fit_type"),this.placeholder=salla.url.asset("images/s-empty.png"),this.getProps(),this.source=salla.config.get("page.slug"),"landing-page"==this.source&&(this.hideAddBtn=!0,this.showQuantity=window.showQuantity),salla.lang.onLoaded(function(){t.remained=salla.lang.get("pages.products.remained"),t.donationAmount=salla.lang.get("pages.products.donation_amount"),t.startingPrice=salla.lang.get("pages.products.starting_price"),t.addToCart=salla.lang.get("pages.cart.add_to_cart"),t.outOfStock=salla.lang.get("pages.products.out_of_stock"),t.discount=salla.lang.get("card.discount"),t.render()}),this.render()}},{key:"formatDate",value:function(t){var n=new Date(t);return"".concat(n.getFullYear(),"-").concat(n.getMonth()+1,"-").concat(n.getDate())}},{key:"getProductBadge",value:function(){return this.product.promotion_title?this.fullImage?'<div class="absolute z-10 top-10 start-0">\n          <div class="font-bold px-3 py-2 text-sm bg-red-500 text-white rounded-e-md">'.concat(this.product.promotion_title,"</div>\n        </div>"):'<div class="absolute top-4 start-0 z-1 font-bold px-1 py-0.5 text-xs bg-primary text-white '.concat(this.isHorizontal?"":"max-w-[calc(100%-60px)]",'">\n        <span class="offer-label truncate">').concat(this.product.promotion_title,"</span>\n      </div>"):""}},{key:"getSubImage",value:function(){return this.product.images&&this.product.images.length>1?'<img class="sub-image object-cover" src="'.concat(this.product.images[1].url,'" alt="').concat(this.product.name,'" />'):""}},{key:"getPriceFormat",value:function(t){return t&&0!=t?salla.money(t):salla.config.get("store.settings.product.show_price_as_dash")?"-":""}},{key:"getProductPrice",value:function(){var t="",n=Math.floor(this.product.discount_percentage||0);if(this.fullImage)if(this.product.is_on_sale)t='<div class="flex-1 flex items-center gap-1.5 justify-between flex-wrap">\n          <div class="flex flex-col items-start gap-0.5 tracking-widest">\n            <span class="text-slate-700 text-lg font-semibold relative regular-price before:!bg-slate-700">'.concat(this.getPriceFormat(this.product.regular_price),'</span>\n            <span class="text-primary font-extrabold text-4xl">').concat(this.getPriceFormat(this.product.sale_price),"</span>\n          </div>\n          ").concat(this.product.discount_percentage?'\n          <div class="relative rounded-lg overflow-hidden">\n            <span class="bg"></span>\n            <span class="sale-ratio">'.concat(this.discount," ").concat(n,"%</span>\n          </div>"):"","\n        </div>");else{var a=this.getPriceFormat(this.product.regular_price).split(" "),e=a[0]||"",o=a.slice(1).join(" ")||"";t='<span class="text-primary font-extrabold text-3xl">'.concat(e,'\n          <span class="text-base tracking-normal">').concat(o,"</span>\n        </span>")}else t=this.product.is_on_sale?'<div class="flex gap-1.5 justify-between '.concat(this.isHorizontal?"flex-wrap items-center":"flex-col items-start xs:items-center xs:flex-row flex-1",'">\n          <div class="w-full xs:w-auto flex gap-3 xs:flex-col items-start xs:gap-[1px]">\n            <span class="text-[#969696] text-base font-semibold relative regular-price">').concat(this.getPriceFormat(this.product.regular_price),'</span>\n            <span class="text-primary font-bold text-lg md:text-xl">').concat(this.getPriceFormat(this.product.sale_price),"</span>\n          </div>\n          ").concat(this.product.discount_percentage?'\n          <div class="relative rounded-lg overflow-hidden">\n            <span class="bg"></span>\n            <span class="sale-ratio">'.concat(this.discount," ").concat(n,"%</span>\n          </div>"):"","\n        </div>"):this.product.starting_price?'<div class="flex items-center gap-2.5">\n          <span class="font-semibold text-red-500">'.concat(this.startingPrice,'</span>\n          <h4 class="text-primary font-extrabold text-sm inline-block">').concat(this.getPriceFormat(this.product.starting_price),"</h4>\n        </div>"):'<span class="text-primary font-bold text-lg md:text-xl '.concat(this.isHorizontal?"":"flex-1",'">').concat(this.getPriceFormat(this.product.regular_price),"</span>");return t}},{key:"getAddButtonLabel",value:function(){return"sale"===this.product.status&&"booking"===this.product.type?salla.lang.get("pages.cart.book_now"):"sale"===this.product.status?salla.lang.get("pages.cart.add_to_cart"):"donating"!==this.product.type?salla.lang.get("pages.products.out_of_stock"):salla.lang.get("pages.products.donation_exceed")}},{key:"getWishlistButton",value:function(){return!salla.config.isGuest()&&salla.storage.get("salla::wishlist",[]).includes(Number(this.product.id)),'<salla-button shape="icon" fill="none" aria-label="Add or remove to wishlist" class="btn--wishlist animated"\n      onclick="salla.wishlist.toggle('.concat(this.product.id,')" data-id="').concat(this.product.id,'">\n      <i class="sicon-heart text-lg ').concat(this.isHorizontal?"":"px-1",'"></i>\n    </salla-button>')}},{key:"getCompareButton",value:function(){return salla.config.get("theme.settings.enable_compare_products")?'<salla-button fill="solid" product-id="'.concat(this.product.id,'" class="btn--compare"\n      onclick="salla.event.emit(\'product::add-to-compare\', {button: this})">\n      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"\n        stroke="currentColor" class="').concat(this.isHorizontal?"w-6 h-6":"w-5 h-5",'">\n        <path stroke-linecap="round" stroke-linejoin="round"\n          d="M12 3v17.25m0 0c-1.472 0-2.882.265-4.185.75M12 20.25c1.472 0 2.882.265 4.185.75M18.75 4.97A48.416 48.416 0 0012 4.5c-2.291 0-4.545.16-6.75.47m13.5 0c1.01.143 2.01.317 3 .52m-3-.52l2.62 10.726c.122.499-.106 1.028-.589 1.202a5.988 5.988 0 01-2.031.352 5.988 5.988 0 01-2.031-.352c-.483-.174-.711-.703-.59-1.202L18.75 4.971zm-16.5.52c.99-.203 1.99-.377 3-.52m0 0l2.62 10.726c.122.499-.106 1.028-.589 1.202a5.989 5.989 0 01-2.031.352 5.989 5.989 0 01-2.031-.352c-.483-.174-.711-.703-.59-1.202L5.25 4.971z" />\n      </svg>\n    </salla-button>'):""}},{key:"getAddToCartButton",value:function(){var t=salla.config.get("theme.settings.add_to_cart_as_icon");return!this.isHorizontal&&t?'<salla-add-product-button class="add-to-cart-custom" product-id="'.concat(this.product.id,'"\n        product-status="').concat(this.product.status,'" product-type="').concat(this.product.type,'">\n        <i class="sicon-cart-add text-lg text-white"></i>\n      </salla-add-product-button>'):this.isHorizontal||t?"":'<salla-add-product-button class="optional-btn" product-status="'.concat(this.product.status,'"\n        product-type="').concat(this.product.type,'" product-id="').concat(this.product.id,'">\n        <i class="sicon-cart-add text-xl"></i>\n        <span>').concat(this.product.add_to_cart_label||this.getAddButtonLabel(),"</span>\n      </salla-add-product-button>")}},{key:"getQuickBuyButton",value:function(){return!this.isHorizontal&&salla.config.get("theme.settings.enable_quick_buy")?'<salla-quick-buy\n        product-id="'.concat(this.product.id,'"\n        product-type="').concat(this.product.type,'"\n        product-status="').concat(this.product.status,'">\n      </salla-quick-buy>'):""}},{key:"getDonationInput",value:function(){return this.product.is_donation?"<salla-progress-bar donation='".concat(JSON.stringify(this.product.donation),'\'></salla-progress-bar>\n    <div class="border-color mb-2.5 w-full">\n      ').concat(this.product.can_donate?'\n      <label for="donation-amount-'.concat(this.product.id,'" class="block text-sm mb-2.5">').concat(this.donationAmount,'\n        <span class="text-red-500">*</span></label>\n      <input type="text" data-digits id="donation-amount-').concat(this.product.id,'" name="donating_amount" class="h-9 form-input"\n        placeholder="').concat(this.donationAmount,'">'):"","\n    </div>"):""}},{key:"getSpecialContent",value:function(){return this.isSpecial&&this.fullImage&&this.product.is_on_sale?'<div class="w-full xs:w-[85%] mx-auto flex items-center flex-row-reverse my-5 gap-2 xs:gap-4 justify-between">\n      '.concat(this.product.quantity?'\n      <div data-quantity="'.concat(this.product.quantity,'"\n        data-total="').concat(this.product.quantity>100?2*this.product.quantity:100,'" class="pie-wrapper">\n        <span class="!leading-[0.5rem] !text-sm">\n          <b id="staProductQty" title="').concat(salla.helpers.number(this.product.quantity),'" data-quantity="').concat(this.product.quantity,'">').concat(salla.helpers.number(this.product.quantity),"</b>\n          ").concat(this.remained,'\n        </span>\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="-2 -1 36 34" class="pie-svg">\n          <circle cx="16" cy="16" r="15.9155" class="circle_base"></circle>\n          <circle cx="16" cy="16" r="15.9155" class="circle_bar"></circle>\n        </svg>\n      </div>'):"","\n      \n      ").concat(this.product.discount_ends?'\n      <div class="salla-counter basis-[70%]">\n        <salla-count-down class="w-full" date="'.concat(this.product.discount_ends,'" boxed labeled></salla-count-down>\n      </div>'):"","\n    </div>"):""}},{key:"getFullImageActions",value:function(){return this.fullImage?'<div class="actions">\n      '.concat(this.getWishlistButton(),'\n      <salla-add-product-button class="add-to-cart-custom" product-id="').concat(this.product.id,'"\n        product-status="').concat(this.product.status,'" product-type="').concat(this.product.type,'">\n        <i class="sicon-cart-add text-xl"></i>\n      </salla-add-product-button>\n      ').concat(this.getCompareButton(),"\n    </div>"):""}},{key:"getHorizontalActions",value:function(){return this.isHorizontal?'<div class="actions">\n      '.concat(this.getWishlistButton(),'\n      <salla-add-product-button class="add-to-cart-custom" product-id="').concat(this.product.id,'"\n        product-status="').concat(this.product.status,'" product-type="').concat(this.product.type,'">\n        <i class="sicon-cart-add text-lg"></i>\n      </salla-add-product-button>\n      ').concat(this.getCompareButton(),"\n    </div>"):""}},{key:"getProps",value:function(){this.isHorizontal=this.hasAttribute("horizontal"),this.fullImage=this.hasAttribute("fullImage"),this.shadowOnHover=this.hasAttribute("shadowOnHover"),this.hideAddBtn=this.hasAttribute("hideAddBtn"),this.isSpecial=this.hasAttribute("isSpecial"),this.showQuantity=this.hasAttribute("showQuantity"),this.blockClasses=this.getAttribute("block-classes")||""}},{key:"render",value:function(){var t,n,a,e=this;this.classList.add("product-entry"),this.blockClasses&&this.blockClasses.trim()&&this.blockClasses.split(" ").forEach(function(t){t.trim()&&e.classList.add(t.trim())}),this.fullImage?(this.classList.add("product-entry--full-image","rounded-md","overflow-hidden","min-h-[420px]","max-h-[460px]"),this.isSpecial?this.classList.add("md:max-h-[640px]"):this.classList.add("md:max-h-none")):(this.classList.add(this.isHorizontal?"product-entry--horizontal":"product-entry--vertical"),this.classList.add("overflow-hidden","relative")),this.isSpecial&&this.classList.add("product-entry--special"),(null===(t=this.product)||void 0===t?void 0:t.discount_ends)&&this.classList.add("with-timer"),this.fitImageHeight&&!this.isSpecial&&this.classList.add("product-entry--fit-type"),(null===(n=this.product)||void 0===n?void 0:n.is_out_of_stock)&&this.classList.add("out-of-stock"),this.setAttribute("id","product-".concat(this.product.id));var o,s,i,c,r,l=this.product.subtitle&&(this.fullImage||salla.config.get("theme.settings.show_sub_title")),u=salla.config.get("theme.settings.add_to_cart_as_icon"),d=salla.config.get("theme.settings.slider_background_size")||"cover";this.fullImage?this.innerHTML='\n        <a href="'.concat(this.product.url,'" class="relative overflow-hidden w-full h-full bg-stone-50">\n          <img class="h-full w-full object-').concat(d,' lazy"\n            src="').concat(this.placeholder,'" data-src="').concat(null===(o=this.product.image)||void 0===o?void 0:o.url,'" alt="').concat(null===(s=this.product.image)||void 0===s?void 0:s.alt,'"/>\n        </a>\n\n        ').concat(this.getProductBadge(),'\n\n        \x3c!-- Content --\x3e\n        <div class="absolute w-[90%] left-[5%] bottom-[2.5%] xs:bottom-[5%]">\n          ').concat(this.getSpecialContent(),'\n\n          <div class="flex flex-col gap-1 bg-white/80 rounded-md p-3 z-10">\n            ').concat(l?'<p class="text-sm text-slate-600 leading-6 truncate">'.concat(this.product.subtitle,"</p>"):"",'\n            <h3 class="max-w-full text-sm md:text-base my-1 truncate">').concat(this.product.name,'</h3>\n\n            <div class="flex-1 flex gap-2 flex-wrap items-end">\n              ').concat(this.getProductPrice(),"\n            </div>\n          </div>\n        </div>\n\n        ").concat(this.getFullImageActions(),"\n      "):this.innerHTML='\n        <div class="product-entry__image '.concat(this.isHorizontal?"":"border border-stone-100 hover:!opacity-100",'">\n          <a href="').concat(this.product.url,'">\n            <img width="100%" class="object-').concat(salla.url.is_placeholder(null===(i=this.product.image)||void 0===i?void 0:i.url)?"contain":this.fitImageHeight||"cover",' bg-stone-50 lazy"\n              src="').concat(this.placeholder,'" data-src="').concat(null===(c=this.product.image)||void 0===c?void 0:c.url,'"\n              alt="').concat(null===(r=this.product.image)||void 0===r?void 0:r.alt,'" />\n            ').concat(this.getProductBadge(),"\n            ").concat(this.getSubImage(),"\n          </a>\n\n          ").concat(this.isHorizontal?"":'\n          <div class="absolute rtl:left-[4px] ltr:right-[4px] top-[9px] flex flex-col items-baseline justify-center gap-2">\n            '.concat(this.getWishlistButton(),"\n            ").concat(this.getCompareButton(),"\n          </div>"),"\n\n          ").concat(!this.isHorizontal&&u?this.getAddToCartButton():"",'\n        </div>\n\n        \x3c!-- Content --\x3e\n        <div class="').concat(this.isHorizontal?"py-2 px-2 md:px-3":"p-2"," ").concat(u?"pt-4 pb-2 px-2":""," ").concat(this.isSpecial?"":"flex-1",' flex flex-col gap-0.5 relative donating-wrap">\n          ').concat(l?'<p class="text-sm text-gray-400 leading-6 '.concat(this.isHorizontal?"p-2-line":"truncate",'">').concat(this.product.subtitle,"</p>"):"",'\n          \n          <a href="').concat(this.product.url,'">\n            <span class="block max-w-full text-sm md:text-base mt-0.5 hover:text-primary transition-all duration-150 ').concat(this.isHorizontal?"p-2-line":"truncate",'">').concat(this.product.name,"</span>\n          </a>\n\n          ").concat(this.getDonationInput(),'\n\n          <div class="flex-1 flex flex-col gap-1.5 flex-wrap ').concat(this.isHorizontal?"mt-3":"mt-1",'">\n            ').concat(this.getProductPrice(),"\n\n            ").concat(this.isHorizontal?"":"\n              ".concat(u?"":this.getAddToCartButton(),"\n              ").concat(this.getQuickBuyButton(),"\n            "),"\n          </div>\n\n          ").concat(this.getHorizontalActions(),"\n        </div>\n      "),this.querySelectorAll('[name="donating_amount"]').forEach(function(t){t.addEventListener("input",function(t){var n;null===(n=t.target.closest(".donating-wrap").querySelector("salla-add-product-button"))||void 0===n||n.setAttribute("donating-amount",t.target.value)})}),null===(a=document.lazyLoadInstance)||void 0===a||a.update(this.querySelectorAll(".lazy"))}}],r&&a(i.prototype,r),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r}(i(HTMLElement));customElements.define("custom-salla-product-card",r)})();